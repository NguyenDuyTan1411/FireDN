@model FireDN.Data.NguoiDung
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
<!-- Bootstrap 3.3.7 -->
@* <link rel="stylesheet" href="~/css/Content/adminlte/components/bootstrap/dist/css/bootstrap.min.css"> *@
<!-- Font Awesome -->
@* <link rel="stylesheet" href="~/css/Content/adminlte/components/font-awesome/css/font-awesome.min.css"> *@
<!-- Ionicons -->
@* <link rel="stylesheet" href="~/css/Content/adminlte/components/Ionicons/css/ionicons.min.css"> *@
<!-- Theme style -->
@* <link rel="stylesheet" href="~/css/Content/adminlte/dist/css/AdminLTE.min.css"> *@
<!-- AdminLTE Skins. Choose a skin from the css/skins
     folder instead of downloading all of them to reduce the load. -->
<link rel="stylesheet" href="~/css/Content/adminlte/dist/css/skins/_all-skins.min.css">
<!-- Morris chart -->
<link rel="stylesheet" href="~/css/Content/adminlte/components/morris.js/morris.css">
<!-- jvectormap -->
<link rel="stylesheet" href="~/css/Content/adminlte/components/jvectormap/jquery-jvectormap.css">
<!-- Date Picker -->
<link rel="stylesheet" href="~/css/Content/adminlte/components/bootstrap-datepicker/dist/css/bootstrap-datepicker.min.css">
<!-- Daterange picker -->
<link rel="stylesheet" href="~/css/Content/adminlte/components/bootstrap-daterangepicker/daterangepicker.css">
<!-- bootstrap wysihtml5 - text editor -->
<link rel="stylesheet" href="~/css/Content/adminlte/plugins/bootstrap-wysihtml5/bootstrap3-wysihtml5.min.css">
<link rel="stylesheet" href="~/css/all.css" />
@* <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" /> *@
@* <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" /> *@
@* <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/admin-lte/3.1.0/css/adminlte.min.css" /> *@
@* <link rel="stylesheet" href="~/css/custom.css" /> *@
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,600,700,300italic,400italic,600italic">

<div class="container-fluid">
    <nav class="navbar navbar-light bg-light">
        <form class="container-fluid justify-content-start">
            <ul class="nav nav-tabs">
                <li class="nav-item">
                    <a class="nav-link active" href="#profile" data-toggle="tab">Profile</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="#grantPermission" data-toggle="tab">Cấp Quyền</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="#editProfile" data-toggle="tab">Chỉnh Sửa Profile</a>
                </li>
            </ul>
        </form>
    </nav>
    <div class="tab-content">
        <div class="tab-pane" id="profile">
            <!-- Nội dung của tab "Profile" -->
            @if (User.Identity.IsAuthenticated)
            {
                <section class="container-fluid px-0 py-5">
                    <div class="row justify-content-center">
                        <div class="col-md-8">
                            <div class="card" style="border-radius: 15px;">
                                <div class="card-body p-4">
                                    <div class="row">
                                        <div class="col-md-4">
                                            @if (Model.HinhAnh != null)
                                            {
                                                <img src="data:image/jpeg;base64,@Convert.ToBase64String(Model.HinhAnh)" alt="Hình ảnh người dùng" class="img-fluid rounded" style="border-radius: 10px;">
                                            }
                                        </div>
                                        <div class="col-md-8">
                                            <h5 class="mb-3">Tên người dùng: @Model.Username</h5>
                                            <p class="mb-2">Vai trò: @Model.RoleUser</p>
                                            <p class="mb-0">Email: @Model.Gmail</p>
                                            <p class="mb-2">Quyền: Chỉnh sửa, cấp quyền (Sensore và người dùng)</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </section>



            }
            else
            {
                <p>Vui lòng đăng nhập để xem thông tin cá nhân.</p>
            }
        </div>
        <div class="tab-pane" id="grantPermission">
            <!-- Nội dung của tab "Cấp Quyền" -->
            @if (User.IsInRole("Admin"))
            {
                @if (User.IsInRole("Admin"))
                {
                    <!-- ============================ COMPONENT ADD NEW USER ================================= -->
                    <div class="card">
                        <div class="card-body">
                            <form asp-controller="Home" asp-action="AddUser" method="post" enctype="multipart/form-data">
                                <div class="form-group">
                                    <label for="username">Tên người dùng</label>
                                    <input type="text" class="form-control" id="username" name="Username" placeholder="Tên người dùng" required>
                                </div>
                                <div class="form-group">
                                    <label for="password">Mật khẩu</label>
                                    <input type="password" class="form-control" id="password" name="PassWord" placeholder="Mật khẩu" required>
                                </div>
                                <div class="form-group">
                                    <label for="role">Vai trò</label>
                                    <select class="form-control" id="role" name="RoleUser" required>
                                        <option value="">Chọn vai trò</option>
                                        <option value="Admin">Admin</option>
                                        <option value="Monitor">Monitor</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label for="email">Email</label>
                                    <input type="email" class="form-control" id="email" name="Gmail" placeholder="Email" required>
                                </div>
                                <div class="form-group">
                                    <label for="image">Hình ảnh</label>
                                    <input type="file" class="form-control-file" id="image" name="HinhAnh" accept="image/*">
                                </div>
                                <button type="submit" class="btn btn-primary btn-block">Thêm người dùng</button>
                            </form>
                        </div> <!-- card-body end.// -->
                    </div> <!-- card end.// -->
                    <!-- ============================ COMPONENT ADD NEW USER END.// ================================= -->
                }



                @if (User.IsInRole("Admin"))
                {
                    @if (ViewBag.DanhSachNguoiDung != null && ViewBag.DanhSachNguoiDung.Count > 0)
                    {
                        <h2>Danh sách người dùng</h2>
                        <ul>
                            <div class="row">
                                @foreach (var user in ViewBag.DanhSachNguoiDung)
                                {
                                    <div class="col-lg-3 mb-4">
                                        <div class="card">
                                            <div class="card-body">
                                                <figure class="itemside align-items-center">
                                                    <div class="aside"><img src="data:image/jpeg;base64,@Convert.ToBase64String(user.HinhAnh)" alt="Hình ảnh người dùng" class="img-fluid"></div>
                                                    <figcaption class="info">
                                                        <a href="#" class="title text-dark">Tên người dùng: @user.Username</a>
                                                        <p class="text-muted small">Vai trò: @user.RoleUser</p>
                                                    </figcaption>
                                                </figure>
                                                <form asp-controller="Home" asp-action="DeleteUser" method="post">
                                                    <input type="hidden" name="id" value="@user.Iduser">
                                                    <button type="submit" class="btn btn-light btn-sm mt-2">Xóa người dùng</button>
                                                </form>
                                            </div>
                                        </div>
                                    </div>
                                }
                            </div>
                        </ul>


                    }
                    else
                    {
                        <p>Không có người dùng nào để hiển thị.</p>
                    }

                }

            }
            else
            {
                <p>Chỉ người dùng có vai trò "Admin" mới có thể truy cập vào phần này.</p>
            }
        </div>
        <div class="tab-pane" id="editProfile">
            <!-- Nội dung của tab "Chỉnh Sửa Profile" -->
            @if (User.Identity.IsAuthenticated)
            {
                @if (User.IsInRole("Admin") || User.Identity.Name == Model.Username)
                {
                    <h2>Chỉnh sửa thông tin người dùng</h2>
                    <form asp-controller="Home" asp-action="Edit" method="post" enctype="multipart/form-data">
                        <input type="hidden" name="Iduser" value="@Model.Iduser">
                        <div class="card">
                            <div class="card-body">
                                <h4 class="card-title mb-4">Profile</h4>
                                <div class="form-group">
                                    @if (Model.HinhAnh != null)
                                    {
                                        <img src="data:image/jpeg;base64,@Convert.ToBase64String(Model.HinhAnh)" alt="Hình ảnh người dùng" class="img-sm rounded-circle border" style="max-width: 100px;">
                                    }
                                </div>
                                <div class="form-group">
                                    <label for="HinhAnh">Chọn hình ảnh:</label>
                                    <input type="file" id="HinhAnh" name="HinhAnh" class="form-control-file">
                                </div>
                                <div class="form-row">
                                    <div class="col form-group">
                                        <label for="Username">Tên người dùng</label>
                                        <input type="text" id="Username" name="Username" class="form-control" value="@Model.Username">
                                    </div>
                                    <div class="col form-group">
                                        <label for="Email">Email</label>
                                        <input type="email" id="Email" name="Email" class="form-control" value="@Model.Gmail">
                                    </div>
                                </div>
                                <div class="form-row">
                                    <div class="form-group col-md-6">
                                        <label for="NewPassword">Mật khẩu</label>
                                        <input type="password" id="NewPassword" name="NewPassword" class="form-control">
                                    </div>
                                    <div class="form-group col-md-6">
                                        <label for="RoleUser">Vai Trò</label>
                                        <select id="RoleUser" name="RoleUser" class="form-control">
                                            <option> Choose...</option>
                                            <option>Admin</option>
                                            <option>Monitor</option>
                                        </select>
                                    </div>
                                </div>
                                <button type="submit" class="btn btn-primary btn-block">Lưu chỉnh sửa</button>
                            </div>
                        </div>
                    </form>

                }
            }
            else
            {
                <p>Vui lòng đăng nhập để chỉnh sửa thông tin cá nhân.</p>
            }

        </div>
    </div>
</div>
</div>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script>
    $(document).ready(function () {
        $('.tab-title').click(function () {
            $('.tab-title').removeClass('active');
            $(this).addClass('active');

            $('.tab-content').removeClass('active');
            var contentId = $(this).attr('href');
            $(contentId).addClass('active');
        });
    });
</script>
<style>
    .tab-title {
        border: 1px solid #ddd;
        border-radius: 4px;
        padding: 5px 10px;
        margin-bottom: 10px;
        display: inline-block;
        transition: all 0.3s ease;
        cursor: pointer;
        background-color: #fff; /* Màu nền */
        box-shadow: 0 0 5px rgba(0, 0, 0, 0.1); /* Đổ bóng */
    }

        .tab-title.active {
            border-bottom: 1px solid transparent;
            padding-bottom: 4px;
            background-color: #fff; /* Màu nền */
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.2); /* Đổ bóng mạnh hơn */
        }

    .tab-content.active {
        display: block;
        background-color: #fff; /* Màu nền */
        padding: 10px; /* Thêm padding cho nội dung */
        border: 1px solid #ddd;
        border-top: 0;
        border-radius: 0 0 4px 4px;
    }

</style>


